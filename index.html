<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å€Ÿé’±æŠ•èµ„ç›ˆäºå¹³è¡¡è®¡ç®—å™¨</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 24px;
            height: 24px;
            background: white;
            border: 3px solid #0075be;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(0, 117, 190, 0.4);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: white;
            border: 3px solid #0075be;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }
        
        input[type="range"]::-moz-range-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(0, 117, 190, 0.4);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Icon components
        const Calculator = ({ className, style }) => (
            <svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
            </svg>
        );

        const Percent = ({ className, style }) => (
            <svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7L5 11m0 0l4 4M5 11h14m0 0l-4-4m4 4l-4 4" />
                <circle cx="7" cy="7" r="1.5" fill="currentColor" />
                <circle cx="17" cy="17" r="1.5" fill="currentColor" />
            </svg>
        );

        const DollarSign = ({ className, style }) => (
            <svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const TrendingUp = ({ className, style }) => (
            <svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
            </svg>
        );

        function InvestmentCalculator() {
            const [interestRate, setInterestRate] = useState(5);
            const [annualIncome, setAnnualIncome] = useState(200000);
            
            // è®¡ç®—è¾¹é™…ç¨ç‡ - 2025å¹´å®‰å¤§ç•¥çœå¤šä¼¦å¤šå¸‚ç¨ç‡ï¼ˆå«é™„åŠ ç¨ï¼‰
            const calculateMarginalTaxRate = (income) => {
                // è”é‚¦ç¨ç‡ (2025)
                let federalRate = 0;
                if (income <= 55867) {
                    federalRate = 15;
                } else if (income <= 111733) {
                    federalRate = 20.5;
                } else if (income <= 173205) {
                    federalRate = 26;
                } else if (income <= 246752) {
                    federalRate = 29;
                } else {
                    federalRate = 33;
                }
                
                // å®‰å¤§ç•¥çœåŸºæœ¬ç¨ç‡ (2025)
                let baseProvincialRate = 0;
                if (income <= 51446) {
                    baseProvincialRate = 5.05;
                } else if (income <= 102894) {
                    baseProvincialRate = 9.15;
                } else if (income <= 150000) {
                    baseProvincialRate = 11.16;
                } else if (income <= 220000) {
                    baseProvincialRate = 12.16;
                } else {
                    baseProvincialRate = 13.16;
                }
                
                // å®‰å¤§ç•¥çœé™„åŠ ç¨ (Surtax)
                // 20%é™„åŠ ç¨é€‚ç”¨äºçœç¨è¶…è¿‡$5,315 (çº¦$72,000æ”¶å…¥)
                // é¢å¤–36%é™„åŠ ç¨é€‚ç”¨äºçœç¨è¶…è¿‡$6,839 (çº¦$91,000æ”¶å…¥)
                // å¯¹äºé«˜æ”¶å…¥è€…ï¼Œæ€»é™„åŠ ç¨ä¸º56% (20% + 36%)
                let effectiveProvincialRate = baseProvincialRate;
                
                if (income > 91000) {
                    // é«˜æ”¶å…¥ï¼šåŸºæœ¬ç¨ç‡ Ã— 1.56 (åŒ…å«56%é™„åŠ ç¨)
                    effectiveProvincialRate = baseProvincialRate * 1.56;
                } else if (income > 72000) {
                    // ä¸­é«˜æ”¶å…¥ï¼šåŸºæœ¬ç¨ç‡ Ã— 1.20 (åŒ…å«20%é™„åŠ ç¨)
                    effectiveProvincialRate = baseProvincialRate * 1.20;
                }
                
                return federalRate + effectiveProvincialRate;
            };
            
            const marginalTaxRate = calculateMarginalTaxRate(annualIncome);
            const capitalGainsTaxRate = marginalTaxRate / 2;
            
            // è®¡ç®—
            const afterTaxCost = interestRate * (1 - marginalTaxRate / 100);
            const afterTaxRetention = 1 - capitalGainsTaxRate / 100;
            const breakEvenReturn = afterTaxCost / afterTaxRetention;
            
            const getFederalRate = () => {
                if (annualIncome <= 55867) return '15.00';
                if (annualIncome <= 111733) return '20.50';
                if (annualIncome <= 173205) return '26.00';
                if (annualIncome <= 246752) return '29.00';
                return '33.00';
            };

            const getFederalBracket = () => {
                if (annualIncome <= 55867) return 'æ”¶å…¥æ¡£æ¬¡: $0 - $55,867';
                if (annualIncome <= 111733) return 'æ”¶å…¥æ¡£æ¬¡: $55,868 - $111,733';
                if (annualIncome <= 173205) return 'æ”¶å…¥æ¡£æ¬¡: $111,734 - $173,205';
                if (annualIncome <= 246752) return 'æ”¶å…¥æ¡£æ¬¡: $173,206 - $246,752';
                return 'æ”¶å…¥æ¡£æ¬¡: $246,753+';
            };

            const getProvincialRate = () => {
                let baseRate = 0;
                if (annualIncome <= 51446) baseRate = 5.05;
                else if (annualIncome <= 102894) baseRate = 9.15;
                else if (annualIncome <= 150000) baseRate = 11.16;
                else if (annualIncome <= 220000) baseRate = 12.16;
                else baseRate = 13.16;
                
                // åº”ç”¨é™„åŠ ç¨
                if (annualIncome > 91000) {
                    return (baseRate * 1.56).toFixed(2);
                } else if (annualIncome > 72000) {
                    return (baseRate * 1.20).toFixed(2);
                }
                return baseRate.toFixed(2);
            };

            const getProvincialBracket = () => {
                if (annualIncome <= 51446) return 'æ”¶å…¥æ¡£æ¬¡: $0 - $51,446';
                if (annualIncome <= 102894) return 'æ”¶å…¥æ¡£æ¬¡: $51,447 - $102,894';
                if (annualIncome <= 150000) return 'æ”¶å…¥æ¡£æ¬¡: $102,895 - $150,000';
                if (annualIncome <= 220000) return 'æ”¶å…¥æ¡£æ¬¡: $150,001 - $220,000';
                return 'æ”¶å…¥æ¡£æ¬¡: $220,001+';
            };
            
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-sky-50 to-cyan-50 p-8">
                    <div className="max-w-4xl mx-auto">
                        {/* æ ‡é¢˜ */}
                        <div className="text-center mb-12">
                            <div className="flex items-center justify-center gap-3 mb-4">
                                <Calculator className="w-10 h-10" style={{ color: '#0075be' }} />
                                <h1 className="text-4xl font-bold text-gray-800">å€Ÿé’±æŠ•èµ„ç›ˆäºå¹³è¡¡è®¡ç®—å™¨</h1>
                            </div>
                            <p className="text-gray-600 text-lg">è°ƒæ•´å€Ÿæ¬¾åˆ©ç‡ï¼Œçœ‹çœ‹ä½ éœ€è¦èµšå¤šå°‘æ‰ä¸äº</p>
                        </div>

                        {/* ä¸»å¡ç‰‡ */}
                        <div className="bg-white rounded-3xl shadow-2xl p-8 mb-8">
                            {/* æ»‘å—åŒºåŸŸ - å·¦å³æ’åˆ— */}
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                {/* åˆ©ç‡æ»‘å— */}
                                <div>
                                    <div className="flex items-center justify-between mb-4">
                                        <label className="text-lg font-semibold text-gray-700 flex items-center gap-2">
                                            <Percent className="w-5 h-5" style={{ color: '#0075be' }} />
                                            å€Ÿæ¬¾åˆ©ç‡
                                        </label>
                                        <span className="text-3xl font-bold" style={{ color: '#0075be' }}>{interestRate.toFixed(1)}%</span>
                                    </div>
                                    <input
                                        type="range"
                                        min="0"
                                        max="15"
                                        step="0.1"
                                        value={interestRate}
                                        onChange={(e) => setInterestRate(parseFloat(e.target.value))}
                                        className="w-full h-3 bg-blue-100 rounded-lg appearance-none cursor-pointer slider"
                                        style={{
                                            background: `linear-gradient(to right, #0075be 0%, #0075be ${(interestRate / 15) * 100}%, #dbeafe ${(interestRate / 15) * 100}%, #dbeafe 100%)`
                                        }}
                                    />
                                    <div className="flex justify-between text-sm text-gray-500 mt-2">
                                        <span>0%</span>
                                        <span>15%</span>
                                    </div>
                                </div>

                                {/* å¹´æ”¶å…¥æ»‘å— */}
                                <div>
                                    <div className="flex items-center justify-between mb-4">
                                        <label className="text-lg font-semibold text-gray-700 flex items-center gap-2">
                                            <DollarSign className="w-5 h-5" style={{ color: '#0075be' }} />
                                            T4å¹´æ”¶å…¥
                                        </label>
                                        <span className="text-3xl font-bold" style={{ color: '#0075be' }}>
                                            ${(annualIncome / 1000).toFixed(0)}K
                                        </span>
                                    </div>
                                    <input
                                        type="range"
                                        min="0"
                                        max="1000000"
                                        step="10000"
                                        value={annualIncome}
                                        onChange={(e) => setAnnualIncome(parseFloat(e.target.value))}
                                        className="w-full h-3 bg-blue-100 rounded-lg appearance-none cursor-pointer slider"
                                        style={{
                                            background: `linear-gradient(to right, #0075be 0%, #0075be ${(annualIncome / 1000000) * 100}%, #dbeafe ${(annualIncome / 1000000) * 100}%, #dbeafe 100%)`
                                        }}
                                    />
                                    <div className="flex justify-between text-sm text-gray-500 mt-2">
                                        <span>$0</span>
                                        <span>$1M</span>
                                    </div>
                                </div>
                            </div>
                            
                            {/* ç¨ç‡è¯¦ç»†å±•ç¤º - å·¦å³æ’åˆ— */}
                            <div className="mb-8">
                                {/* è”é‚¦å’Œçœç¨ç‡ */}
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    {/* è”é‚¦ç¨ç‡ */}
                                    <div className="bg-gradient-to-r from-red-50 to-red-100 rounded-lg p-4 border-l-4 border-red-500">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-sm font-semibold text-gray-700">ğŸ‡¨ğŸ‡¦ è”é‚¦ç¨ç‡</span>
                                            <span className="text-lg font-bold text-red-700">
                                                {getFederalRate()}%
                                            </span>
                                        </div>
                                        <div className="text-xs text-gray-600">
                                            {getFederalBracket()}
                                        </div>
                                    </div>

                                    {/* çœç¨ç‡ */}
                                    <div className="bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border-l-4" style={{ borderLeftColor: '#0075be' }}>
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-sm font-semibold text-gray-700">ğŸ›ï¸ å®‰å¤§ç•¥çœç¨ç‡</span>
                                            <span className="text-lg font-bold" style={{ color: '#0075be' }}>
                                                {getProvincialRate()}%
                                            </span>
                                        </div>
                                        <div className="text-xs text-gray-600">
                                            {getProvincialBracket()}
                                            {annualIncome > 91000 && <div className="mt-1 text-red-600">å«56%é™„åŠ ç¨ (20%+36%)</div>}
                                            {annualIncome > 72000 && annualIncome <= 91000 && <div className="mt-1 text-orange-600">å«20%é™„åŠ ç¨</div>}
                                        </div>
                                    </div>
                                </div>

                                {/* è¾¹é™…ç¨ç‡å’Œèµ„æœ¬åˆ©å¾—ç¨ç‡ */}
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {/* è¾¹é™…ç¨ç‡æ€»è®¡ */}
                                    <div className="bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border-l-4 border-purple-600">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-sm font-semibold text-gray-700">ğŸ“Š è¾¹é™…ç¨ç‡</span>
                                            <span className="text-2xl font-bold text-purple-700">
                                                {marginalTaxRate.toFixed(2)}%
                                            </span>
                                        </div>
                                        <div className="text-xs text-gray-600">
                                            è”é‚¦+çœï¼Œæ¯å¤šèµš$1éœ€ç¼´${(marginalTaxRate / 100).toFixed(2)}ç¨
                                        </div>
                                    </div>

                                    {/* èµ„æœ¬åˆ©å¾—ç¨ç‡ */}
                                    <div className="bg-gradient-to-r from-green-50 to-emerald-100 rounded-lg p-4 border-l-4 border-green-600">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-sm font-semibold text-gray-700">ğŸ’° èµ„æœ¬åˆ©å¾—ç¨ç‡</span>
                                            <span className="text-2xl font-bold text-green-700">
                                                {capitalGainsTaxRate.toFixed(2)}%
                                            </span>
                                        </div>
                                        <div className="text-xs text-gray-600">
                                            {marginalTaxRate.toFixed(2)}% Ã— 50% (ä»…50%è®¡å…¥åº”ç¨)
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* ç»“æœå±•ç¤º */}
                            <div className="rounded-2xl p-8 text-white mb-8" style={{ background: 'linear-gradient(135deg, #0075be 0%, #005587 100%)' }}>
                                <div className="text-center mb-6">
                                    <div className="flex items-center justify-center gap-2 mb-2">
                                        <TrendingUp className="w-6 h-6" />
                                        <h2 className="text-2xl font-bold">ç›ˆäºå¹³è¡¡ç‚¹</h2>
                                    </div>
                                    <p className="opacity-90">ä½ çš„æŠ•èµ„è‡³å°‘éœ€è¦è¾¾åˆ°</p>
                                </div>
                                <div className="text-center">
                                    <div className="text-6xl font-bold mb-2">
                                        {breakEvenReturn.toFixed(2)}%
                                    </div>
                                    <p className="text-lg opacity-90">ç¨å‰æŠ•èµ„å›æŠ¥ç‡</p>
                                </div>
                            </div>

                            {/* è®¡ç®—æ­¥éª¤ - å·¦å³æ’åˆ— */}
                            <div className="space-y-6">
                                <h3 className="text-xl font-bold text-gray-800 mb-4">è®¡ç®—è¿‡ç¨‹</h3>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    {/* æ­¥éª¤1 */}
                                    <div className="bg-blue-50 rounded-xl p-6 border-l-4" style={{ borderLeftColor: '#0075be' }}>
                                        <div className="flex items-start gap-3">
                                            <div className="text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0 mt-1" style={{ backgroundColor: '#0075be' }}>1</div>
                                            <div className="flex-1">
                                                <h4 className="font-semibold text-gray-800 mb-2">å€Ÿæ¬¾çš„çœŸå®æˆæœ¬</h4>
                                                <p className="text-gray-600 mb-3 text-sm">å› ä¸ºåˆ©æ¯å¯ä»¥æŠµç¨,æ”¿åºœå¸®ä½ æ‰¿æ‹…äº†ä¸€éƒ¨åˆ†æˆæœ¬</p>
                                                <div className="bg-white rounded-lg p-4">
                                                    <div className="font-mono text-xs space-y-1">
                                                        <div className="text-gray-600">å®é™…æˆæœ¬ = {interestRate.toFixed(1)}% Ã— (1 - {marginalTaxRate.toFixed(2)}%)</div>
                                                        <div className="text-gray-600">å®é™…æˆæœ¬ = {interestRate.toFixed(1)}% Ã— {(100 - marginalTaxRate).toFixed(2)}%</div>
                                                        <div className="text-base font-bold" style={{ color: '#0075be' }}>= {afterTaxCost.toFixed(3)}%</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* æ­¥éª¤2 */}
                                    <div className="rounded-xl p-6 border-l-4" style={{ backgroundColor: '#e0f2fe', borderLeftColor: '#0284c7' }}>
                                        <div className="flex items-start gap-3">
                                            <div className="text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0 mt-1" style={{ backgroundColor: '#0284c7' }}>2</div>
                                            <div className="flex-1">
                                                <h4 className="font-semibold text-gray-800 mb-2">éœ€è¦çš„æŠ•èµ„å›æŠ¥</h4>
                                                <p className="text-gray-600 mb-3 text-sm">æŠ•èµ„æ”¶ç›Šåªäº¤åŠä»·ç¨,ä½†ä½ åªèƒ½ç•™ä¸‹ {(afterTaxRetention * 100).toFixed(2)}% çš„æ”¶ç›Š</p>
                                                <div className="bg-white rounded-lg p-4">
                                                    <div className="font-mono text-xs space-y-1">
                                                        <div className="text-gray-600">èµ„æœ¬åˆ©å¾—ç¨ç‡ = {marginalTaxRate.toFixed(2)}% Ã· 2 = {capitalGainsTaxRate.toFixed(2)}%</div>
                                                        <div className="text-gray-600">ç¨åç•™å­˜ = 1 - {capitalGainsTaxRate.toFixed(2)}% = {(afterTaxRetention * 100).toFixed(2)}%</div>
                                                        <div className="text-gray-600">ç¨å‰æ”¶ç›Š = {afterTaxCost.toFixed(3)}% Ã· {(afterTaxRetention * 100).toFixed(2)}%</div>
                                                        <div className="text-base font-bold" style={{ color: '#0284c7' }}>= {breakEvenReturn.toFixed(3)}%</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* ç»“è®ºå¡ç‰‡ */}
                        <div className="bg-white rounded-2xl shadow-lg p-6">
                            <div className="flex items-start gap-4">
                                <DollarSign className="w-8 h-8 text-green-600 flex-shrink-0" />
                                <div>
                                    <h3 className="text-xl font-bold text-gray-800 mb-3">ä¸€å¥è¯æ€»ç»“</h3>
                                    <p className="text-gray-700 text-lg leading-relaxed">
                                        å¹´æ”¶å…¥ ${(annualIncome / 1000).toFixed(0)}Kï¼Œè¾¹é™…ç¨ç‡ {marginalTaxRate.toFixed(1)}%ï¼Œ{interestRate.toFixed(1)}% çš„å€Ÿæ¬¾æˆæœ¬éœ€è¦{' '}
                                        <span className="font-bold" style={{ color: '#0075be' }}>{breakEvenReturn.toFixed(2)}%</span>{' '}
                                        çš„æŠ•èµ„å›æŠ¥æ‰èƒ½æ‰“å¹³ã€‚
                                        {breakEvenReturn < 3 && <span className="text-green-600"> è¿™ä¸ªé—¨æ§›ç›¸å¯¹è¾ƒä½ï¼</span>}
                                        {breakEvenReturn >= 3 && breakEvenReturn < 6 && <span style={{ color: '#d97706' }}> éœ€è¦ç¨³å¥çš„æŠ•èµ„ç­–ç•¥ã€‚</span>}
                                        {breakEvenReturn >= 6 && <span className="text-red-600"> è¿™æ˜¯ä¸ªä¸å°çš„æŒ‘æˆ˜ï¼</span>}
                                    </p>
                                </div>
                            </div>
                        </div>

                        {/* é¡µè„š */}
                        <div className="text-center mt-8 text-gray-500 text-sm">
                            <p>åŸºäºå®‰å¤§ç•¥çœå¤šä¼¦å¤šå¸‚2025å¹´ç¨ç‡ï¼ˆå«é™„åŠ ç¨ï¼‰ï¼Œèµ„æœ¬åˆ©å¾—50%è®¡å…¥åº”ç¨æ”¶å…¥</p>
                            <p className="mt-1">è”é‚¦ç¨ç‡ + çœç¨ç‡ï¼ˆå«é™„åŠ ç¨ï¼‰= è¾¹é™…ç¨ç‡ï¼ˆæœ€é«˜53.53%ï¼‰</p>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<InvestmentCalculator />);
    </script>
</body>
</html>
